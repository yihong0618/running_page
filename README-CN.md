![running_page](https://socialify.git.ci/yihong0618/running_page/image?description=1&font=Inter&forks=1&issues=1&language=1&logo=https%3A%2F%2Fraw.githubusercontent.com%2Fshaonianche%2Fgallery%2Fmaster%2Frunning_page%2Frunning_page_logo_150*150.jpg&owner=1&pulls=1&stargazers=1&theme=Light)

# [è¿™é‡Œæ˜¯ç™½é“¶è¶Šé‡èµ›å…¨éƒ¨ 21 ä½é€è€…çš„æ•…äº‹](https://github.com/yihong0618/running_page/issues/135)

R.I.P. å¸Œæœ›å¤§å®¶éƒ½èƒ½å¥åº·é¡ºåˆ©çš„è·‘è¿‡ç»ˆç‚¹ï¼Œé€è€…å®‰æ¯ã€‚

# [æ‰“é€ ä¸ªäººè·‘æ­¥ä¸»é¡µ](https://yihong.run/running)

[English](README.md) | ç®€ä½“ä¸­æ–‡ | [Wiki](https://wiki.mfydev.run/)

<details>
<summary>GIF å±•ç¤º</summary>

![running_page](https://user-images.githubusercontent.com/15976103/98808834-c02f1d80-2457-11eb-9a7c-70e91faa5e30.gif)

</details>

## [å¤§å®¶çš„è·‘æ­¥ä¸»é¡µå±•ç¤º](https://github.com/yihong0618/running_page/issues/12)

| Runner                                          | page                                         | App       |
| ----------------------------------------------- | ---------------------------------------------|-----------|
| [zhubao315](https://github.com/zhubao315)       | <https://zhubao315.github.io/running>        | Strava    |
| [shaonianche](https://github.com/shaonianche)   | <https://run.duanfei.org>                    | Strava    |
| [yihong0618](https://github.com/yihong0618)     | <https://yihong.run>                         | Nike      |
| [superleeyom](https://github.com/superleeyom)   | <https://running.leeyom.top>                 | Nike      |
| [geekplux](https://github.com/geekplux)         | <https://activities.geekplux.com>            | Nike      |
| [guanlan](https://github.com/guanlan)           | <https://grun.vercel.app>                    | Strava    |
| [tuzimoe](https://github.com/tuzimoe)           | <https://run.tuzi.moe>                       | Nike      |
| [ben_29](https://github.com/ben-29)             | <https://running.ben29.xyz>                  | Strava    |
| [kcllf](https://github.com/kcllf)               | <https://running-tau.vercel.app>             | Garmin-cn |
| [mq](https://github.com/MQ-0707)                | <https://running-iota.vercel.app>            | Keep      |
| [zhaohongxuan](https://github.com/zhaohongxuan) | <https://running-page-psi.vercel.app>        | Keep      |
| [yvetterowe](https://github.com/yvetterowe)     | <https://run.haoluo.io>                      | Strava    |
| [love-exercise](https://github.com/KaiOrange)   | <https://run.kai666666.top>                  | Keep      |
| [zstone12](https://github.com/zstone12)         | <https://running-page.zstone12.vercel.app>   | Keep      |
| [Lax](https://github.com/Lax)                   | <https://lax.github.io/running>              | Keep      |
| [lusuzi](https://github.com/lusuzi)             | <https://running.lusuzi.vercel.app>          | Nike      |
| [wh1994](https://github.com/wh1994)             | <https://run4life.fun>                       | Garmin    |
| [liuyihui](https://github.com/YiHui-Liu)        | <https://run.foolishfox.cn>                  | Keep      |
| [sunyunxian](https://github.com/sunyunxian)     | <https://sunyunxian.github.io/running_page>  | Strava    |
| [AhianZhang](https://github.com/AhianZhang)     | <https://running.ahianzhang.com>             | Nike      |
| [L1cardo](https://github.com/L1cardo)           | <https://run.licardo.cn>                     | Nike      |
| [luckylele666](https://github.com/luckylele666) | <https://0000928.xyz>                        | Strava    |
| [MFYDev](https://github.com/MFYDev)             | <https://mfydev.run>                         | Garmin-cn |
| [Oysmart](https://github.com/oysmart)           | <https://run.ouyang.wang>                    | Garmin-cn |
| [Eished](https://github.com/eished)             | <https://run.iknow.fun>                      | Keep      |
| [Liuxin](https://github.com/liuxindtc)          | <https://liuxin.run>                         | Nike      |
| [loucx](https://github.com/loucx)               | <https://loucx.github.io/running>            | Nike      |
| [winf42](https://github.com/winf42)             | <https://winf42.github.io>                   | Garmin-cn |
| [sun0225SUN](https://github.com/sun0225SUN)     | <https://run.sunguoqi.com>                   | Nike      |
| [Zhan](https://www.zlog.in/about)               | <https://run.zlog.in>                        | Nike      |
| [Dennis](https://run.domon.cn)                  | <https://run.domon.cn>                       | Garmin-cn |
| [hanpei](https://running.nexts.top)             | <https://running.nexts.top>    
| [liugezhou](https://github.com/liugezhou)       | <https://run.liugezhou.online>               | Strava    |
| [zhubao315](https://github.com/zhubao315)       | <https://zhubao315.github.io/running>        | Strava    |
| [Jason Tan](https://github.com/Jason-cqtan)     | <https://jason-cqtan.github.io/running_page> | Nike      |
| [Conge](https://github.com/conge)               | <https://conge.github.io/running_page>       | Strava    |
| [cvvz](https://github.com/cvvz)                 | <https://cvvz.github.io/running>             | Strava    |
| [zHElEARN](https://github.com/zHElEARN)         | <https://workouts.zhelearn.com>              | Strava    |
| [Rhfeng](https://sport.frh.life)                | <https://sport.frh.life>                     | Garmin-cn |

## å®ƒæ˜¯æ€ä¹ˆå·¥ä½œçš„

![image](https://user-images.githubusercontent.com/15976103/105784027-e1ad9900-5fb2-11eb-9479-372be21482f1.png)

## ç‰¹æ€§

1. GitHub Actions ç®¡ç†è‡ªåŠ¨åŒæ­¥è·‘æ­¥è¿›ç¨‹åŠè‡ªåŠ¨ç”Ÿæˆæ–°çš„é¡µé¢
2. Gatsby ç”Ÿæˆçš„é™æ€ç½‘é¡µï¼Œé€Ÿåº¦å¿«
3. æ”¯æŒ Vercel(æ¨è) å’Œ GitHub Pages è‡ªåŠ¨éƒ¨ç½²
4. React Hooks
5. Mapbox è¿›è¡Œåœ°å›¾å±•ç¤º
6. Nike åŠ Runtastic(Adidas Run) ä»¥åŠä½³æ˜ï¼ˆä½³æ˜ä¸­å›½ï¼‰åŠ Keep ç­‰ï¼Œè‡ªåŠ¨å¤‡ä»½ gpx æ•°æ®ï¼Œæ–¹ä¾¿å¤‡ä»½åŠä¸Šä¼ åˆ°å…¶å®ƒè½¯ä»¶

> å› ä¸ºæ•°æ®å­˜åœ¨ gpx å’Œ data.db ä¸­ï¼Œç†è®ºä¸Šæ”¯æŒå‡ ä¸ªè½¯ä»¶ä¸€èµ·ï¼Œä½ å¯ä»¥æŠŠä¹‹å‰å„ç±» app çš„æ•°æ®éƒ½åŒæ­¥åˆ°è¿™é‡Œï¼ˆå»ºè®®æœ¬åœ°åŒæ­¥ï¼Œä¹‹å actions é€‰æ‹©æ­£åœ¨ç”¨çš„ appï¼‰

> æ³¨ï¼šå¦‚æœä½ ä¸æƒ³å…¬å¼€æ•°æ®ï¼Œå¯ä»¥é€‰æ‹© strava çš„æ¨¡ç³Šå¤„ç†ï¼Œæˆ– private ä»“åº“ã€‚

<details>
<summary>ç¼©æ”¾åœ°å›¾å½©è›‹</summary>

![image](https://user-images.githubusercontent.com/15976103/95644909-a31bcd80-0aec-11eb-9270-869b0a94f59f.png)

</details>

## æ”¯æŒ

- **[Strava](#strava)**
- **[Nike Run Club](#nike-run-club)**
- **[Garmin](#Garmin)**
- **[Garmin-cn](#garmin-cn-å¤§é™†ç”¨æˆ·è¯·ç”¨è¿™ä¸ª)**
- **[Keep](#Keep)**
- **[æ‚¦è·‘åœˆ](#joyrunæ‚¦è·‘åœˆï¼Œå› æ‚¦è·‘åœˆé™åˆ¶å•ä¸ªè®¾å¤‡åŸå› ï¼Œæ— æ³•è‡ªåŠ¨åŒ–)**
- **[å’•å’š](#codoonå’•å’šï¼Œå› å’•å’šé™åˆ¶å•ä¸ªè®¾å¤‡åŸå› ï¼Œæ— æ³•è‡ªåŠ¨åŒ–)**
- **[GPX](#GPX)**
- **[TCX](#TCX)**
- **[Tcx+Strava(upload all tcx data to strava)](#TCX_to_Strava)**
- **[Gpx+Strava(upload all tcx data to strava)](#GPX_to_Strava)**
- **[Nike+Strava(Using NRC Run, Strava backup data)](#nikestrava)**
- **[Garmin_to_Strava(Using Garmin Run, Strava backup data)](#Garmin_to_Strava)**
- **[Strava_to_Garmin(Using Strava Run, Garmin backup data)](#Strava_to_Garmin)**

## ä¸‹è½½

```
git clone https://github.com/yihong0618/running_page.git --depth=1
```

## å®‰è£…åŠæµ‹è¯• (node >= 12 and <= 14 python >= 3.7)

```
pip3 install -r requirements.txt
yarn install
yarn develop
```

è®¿é—® <http://localhost:8000/> æŸ¥çœ‹

## Docker 
```
#æ„å»º
# NRC
docker build -t running_page:latest . --build-arg app=NRC --build-arg nike_refresh_token=""
# Garmin
docker build -t running_page:latest . --build-arg app=Garmin --build-arg email=""  --build-arg password="" 
# Garmin-CN
docker build -t running_page:latest . --build-arg app=Garmin-CN --build-arg email=""  --build-arg password="" 
# Strava
docker build -t running_page:latest . --build-arg app=Strava --build-arg client_id=""  --build-arg client_secret=""  --build-arg refresch_token="" 
#Nike_to_Strava
docker build -t running_page:latest . --build-arg app=Nike_to_Strava  --build-arg nike_refresh_token="" --build-arg client_id=""  --build-arg client_secret=""  --build-arg refresch_token="" 

#å¯åŠ¨
docker run -itd -p 80:80   running_page:latest

#è®¿é—®
è®¿é—® ip:80 æŸ¥çœ‹

```


## æ›¿æ¢ `src/utils/const.js` æ–‡ä»¶ä¸­çš„ Mapbox token

> å»ºè®®æœ‰èƒ½åŠ›çš„åŒå­¦æŠŠä»£ç ä¸­çš„ Mapbox token è‡ªå·±çš„ [Mapbox token](https://www.mapbox.com/)

```javascript
const MAPBOX_TOKEN =
  'pk.eyJ1IjoieWlob25nMDYxOCIsImEiOiJja2J3M28xbG4wYzl0MzJxZm0ya2Fua2p2In0.PNKfkeQwYuyGOTT_x9BJ4Q';
```

### å¦‚æœä½ æ˜¯æµ·å¤–ç”¨æˆ·è¯·æ›´æ”¹ `IS_CHINESE = false` in `src/utils/const.js`

## ä¸€äº›ä¸ªæ€§åŒ–é€‰é¡¹

- åœ¨ä»“åº“ç›®å½•ä¸‹æ‰¾åˆ° `gatsby-config.js`ï¼Œæ‰¾åˆ°ä»¥ä¸‹å†…å®¹å¹¶ä¿®æ”¹æˆä½ è‡ªå·±æƒ³è¦çš„ã€‚

```javascript
siteMetadata: {
  siteTitle: 'Running Page', #ç½‘ç«™æ ‡é¢˜
  siteUrl: 'https://yihong.run', #ç½‘ç«™åŸŸå
  logo: 'https://encrypted-tbn0.gstatic.com/images?q=tbn:ANd9GcQTtc69JxHNcmN1ETpMUX4dozAgAN6iPjWalQ&usqp=CAU', #å·¦ä¸Šè§’LOGO
  description: 'Personal site and blog',
  navLinks: [
    {
      name: 'Blog', #å³ä¸Šè§’å¯¼èˆªåç§°
      url: 'https://yihong.run/running', #å³ä¸Šè§’å¯¼èˆªé“¾æ¥
    },
    {
      name: 'About',
      url: 'https://github.com/yihong0618/running_page/blob/master/README-CN.md',
    },
  ],
},
```

- ä¿®æ”¹ `src/utils/const.js` æ–‡ä»¶ä¸­çš„æ ·å¼ï¼š

```javascript
// styling: å…³é—­è™šçº¿ï¼šè®¾ç½®ä¸º `false`
const USE_DASH_LINE = true;
// styling: é€æ˜åº¦ï¼š[0, 1]
const LINE_OPACITY = 0.4;
```

## ä¸‹è½½æ‚¨çš„ Nike Run Club/Strava/Garmin/Garmin-cn/Keep æ•°æ®ï¼Œ[åˆ«å¿˜äº†åœ¨ `total` é¡µé¢ç”Ÿæˆå¯è§†åŒ– SVG](#Total-Data-Analysis)

### GPX

<details>
<summary>Make your <code>GPX</code> data</summary>
<br>

æŠŠå…¶å®ƒè½¯ä»¶ç”Ÿæˆçš„ gpx files æ‹·è´åˆ° GPX_OUT ä¹‹åè¿è¡Œ

```python
python3(python) scripts/gpx_sync.py
```

</details>

### TCX

<details>
<summary>Make your <code>TCX</code> data</summary>
<br>

æŠŠå…¶å®ƒè½¯ä»¶ç”Ÿæˆçš„ tcx files æ‹·è´åˆ° TCX_OUT ä¹‹åè¿è¡Œ

```python
python3(python) scripts/tcx_sync.py
```

</details>

### Keep

<details>
<summary>è·å–æ‚¨çš„ Keep æ•°æ®</summary>

> ç¡®ä¿è‡ªå·±çš„è´¦å·èƒ½ç”¨æ‰‹æœºå· + å¯†ç ç™»é™† (ä¸è¦å¿˜è®°æ·»åŠ  secret å’Œæ›´æ”¹è‡ªå·±çš„è´¦å·ï¼Œåœ¨ GitHub Actions ä¸­), æ³¨ï¼šæµ·å¤–æ‰‹æœºå·éœ€è¦æ¢æˆå›½å†… +86 çš„æ‰‹æœºå·

```python
python3(python) scripts/keep_sync.py ${your mobile} ${your password}
```

ç¤ºä¾‹ï¼š

```python
python3(python) scripts/keep_sync.py 13333xxxx example
```

> æ³¨ï¼šæˆ‘å¢åŠ äº† keep å¯ä»¥å¯¼å‡º gpx åŠŸèƒ½ï¼ˆå›  keep çš„åŸå› ï¼Œè·ç¦»å’Œé€Ÿåº¦ä¼šæœ‰ä¸€å®šç¼ºå¤±ï¼‰, æ‰§è¡Œå¦‚ä¸‹å‘½ä»¤ï¼Œå¯¼å‡ºçš„ gpx ä¼šåŠ å…¥åˆ° GPX_OUT ä¸­ï¼Œæ–¹ä¾¿ä¸Šä¼ åˆ°å…¶å®ƒè½¯ä»¶

```python
python3(python) scripts/keep_sync.py ${your mobile} ${your password} --with-gpx
```

ç¤ºä¾‹ï¼š

```python
python3(python) scripts/keep_sync.py 13333xxxx example --with-gpx
```

</details>

<details>
<summary>è·¯çº¿åç§»ä¿®æ­£</summary>

å¦‚æœæ‚¨å¾—åˆ°çš„è¿åŠ¨è·¯çº¿ä¸å®é™…è·¯çº¿å¯¹æ¯”æœ‰æ•´ä½“åç§»ï¼Œå¯ä»¥ä¿®æ”¹ä»£ç ä¸­çš„å‚æ•°è¿›è¡Œä¿®æ­£

> æ³¨ï¼šKeepç›®å‰é‡‡ç”¨çš„æ˜¯GCJ-02åæ ‡ç³»ï¼Œå› æ­¤å¯¼è‡´å¾—åˆ°è¿åŠ¨æ•°æ®åœ¨ä½¿ç”¨WGS-84åæ ‡ç³»çš„å¹³å°ï¼ˆMapboxã€ä½³æ˜ç­‰ï¼‰ä¸­æ˜¾ç¤ºè½¨è¿¹æ•´ä½“åç§»

- ä¿®æ”¹ `scripts/keep_sync.py` æ–‡ä»¶ä¸­çš„å‚æ•°ï¼š

```python
# If your points need trans from gcj02 to wgs84 coordinate which use by Mappbox
TRANS_GCJ02_TO_WGS84 = True
```

</details>

### JoyRunï¼ˆæ‚¦è·‘åœˆï¼‰

<details>
<summary>è·å–æ‚¨çš„æ‚¦è·‘åœˆæ•°æ®</summary>

è·å–ç™»é™†éªŒè¯ç ï¼š

ç¡®ä¿è‡ªå·±çš„è´¦å·èƒ½ç”¨æ‰‹æœºå· + éªŒè¯ç ç™»é™†

ç‚¹å‡»è·å–éªŒè¯ç 
> æ³¨ï¼šä¸è¦åœ¨æ‰‹æœºè¾“å…¥éªŒè¯ç ï¼Œæ‹¿åˆ°éªŒè¯ç å°±å¥½ï¼Œç”¨è¿™ä¸ªéªŒè¯ç æ”¾åˆ°ä¸‹æ–¹å‘½ä»¤ä¸­

![image](https://user-images.githubusercontent.com/15976103/102352588-e3af3000-3fe2-11eb-8131-14946b0262eb.png)

```python
python3(python) scripts/joyrun_sync.py ${your mobile} ${your éªŒè¯ç }
```

ç¤ºä¾‹ï¼š

```python
python3(python) scripts/joyrun_sync.py 13333xxxx xxxx
```

> æ³¨ï¼šæˆ‘å¢åŠ äº† joyrun å¯ä»¥å¯¼å‡º gpx åŠŸèƒ½ï¼Œæ‰§è¡Œå¦‚ä¸‹å‘½ä»¤ï¼Œå¯¼å‡ºçš„ gpx ä¼šåŠ å…¥åˆ° GPX_OUT ä¸­ï¼Œæ–¹ä¾¿ä¸Šä¼ åˆ°å…¶å®ƒè½¯ä»¶

```python
python3(python) scripts/joyrun_sync.py ${your mobile} ${your éªŒè¯ç } --with-gpx
```

ç¤ºä¾‹ï¼š

```python
python3(python) scripts/joyrun_sync.py 13333xxxx example --with-gpx
```

> æ³¨ï¼šå› ä¸ºéªŒè¯ç æœ‰è¿‡æœŸæ—¶é—´ï¼Œæˆ‘å¢åŠ äº† cookie uid sid ç™»é™†çš„æ–¹å¼ï¼Œuid åŠ sid åœ¨æ‚¨ç™»é™†è¿‡ç¨‹ä¸­ä¼šåœ¨æ§åˆ¶å°æ‰“å°å‡ºæ¥

![image](https://user-images.githubusercontent.com/15976103/102354069-05a9b200-3fe5-11eb-9b30-221c32bbc607.png)

ç¤ºä¾‹ï¼š

```python
python3(python) scripts/joyrun_sync.py 1393xx30xxxx 97e5fe4997d20f9b1007xxxxx --from-uid-sid --with-gpx
```

</details>

### Codoonï¼ˆå’•å’šï¼‰

<details>
<summary>è·å–æ‚¨çš„å’•å’šæ•°æ®</summary>

```python
python3(python) scripts/codoon_sync.py ${your mobile or email} ${your password}
```

ç¤ºä¾‹ï¼š

```python
python3(python) scripts/codoon_sync.py 13333xxxx xxxx
```

> æ³¨ï¼šæˆ‘å¢åŠ äº† Codoon å¯ä»¥å¯¼å‡º gpx åŠŸèƒ½ï¼Œæ‰§è¡Œå¦‚ä¸‹å‘½ä»¤ï¼Œå¯¼å‡ºçš„ gpx ä¼šåŠ å…¥åˆ° GPX_OUT ä¸­ï¼Œæ–¹ä¾¿ä¸Šä¼ åˆ°å…¶å®ƒè½¯ä»¶

```python
python3(python) scripts/codoon_sync.py ${your mobile or email} ${your password} --with-gpx
```

ç¤ºä¾‹ï¼š

```python
python3(python) scripts/codoon_sync.py 13333xxxx xxxx --with-gpx
```

> æ³¨ï¼šå› ä¸ºç™»å½• token æœ‰è¿‡æœŸæ—¶é—´é™åˆ¶ï¼Œæˆ‘å¢åŠ äº† refresh_token&user_id ç™»é™†çš„æ–¹å¼ï¼Œrefresh_token åŠ user_id åœ¨æ‚¨ç™»é™†è¿‡ç¨‹ä¸­ä¼šåœ¨æ§åˆ¶å°æ‰“å°å‡ºæ¥

![image](https://user-images.githubusercontent.com/6956444/105690972-9efaab00-5f37-11eb-905c-65a198ad2300.png)

ç¤ºä¾‹ï¼š

```python
python3(python) scripts/codoon_sync.py 54bxxxxxxx fefxxxxx-xxxx-xxxx --from-auth-token
```

</details>

<details>
<summary>è·¯çº¿åç§»ä¿®æ­£</summary>

å¦‚æœæ‚¨å¾—åˆ°çš„è¿åŠ¨è·¯çº¿ä¸å®é™…è·¯çº¿å¯¹æ¯”æœ‰æ•´ä½“åç§»ï¼Œå¯ä»¥ä¿®æ”¹ä»£ç ä¸­çš„å‚æ•°è¿›è¡Œä¿®æ­£

> æ³¨ï¼šå’•å’šæœ€åˆé‡‡ç”¨GCJ-02åæ ‡ç³»ï¼Œåœ¨2014å¹´3æœˆä»½å·¦å³å‡çº§ä¸ºWGS-84åæ ‡ç³»ï¼Œå¯¼è‡´å‡çº§ä¹‹å‰çš„è¿åŠ¨æ•°æ®åœ¨ä½¿ç”¨WGS-84åæ ‡ç³»çš„å¹³å°ï¼ˆMapboxã€ä½³æ˜ç­‰ï¼‰ä¸­æ˜¾ç¤ºè½¨è¿¹æ•´ä½“åç§»

- ä¿®æ”¹ `scripts/codoon_sync.py` æ–‡ä»¶ä¸­çš„å‚æ•°ï¼š

> æ³¨ï¼šTRANS_END_DATE éœ€è¦æ ¹æ®æ‚¨çš„å®é™…æƒ…å†µè®¾å®šï¼Œç¨‹åºä¼šä¿®æ­£è¿™ä¸€å¤©ä¹‹å‰çš„è¿åŠ¨è®°å½•

```python
# If your points need trans from gcj02 to wgs84 coordinate which use by Mappbox
TRANS_GCJ02_TO_WGS84 = True
# trans the coordinate data until the TRANS_END_DATE, work with TRANS_GCJ02_TO_WGS84 = True
TRANS_END_DATE = "2014-03-24"
```

</details>

### Garmin

<details>
<summary>è·å–æ‚¨çš„ Garmin æ•°æ®</summary>
<br>
å¦‚æœä½ åªæƒ³åŒæ­¥è·‘æ­¥æ•°æ®å¢åŠ å‘½ä»¤ --only-run
å¦‚æœä½ æƒ³åŒæ­¥ `tcx` æ ¼å¼ï¼Œå¢åŠ å‘½ä»¤ --tcx


```python
python3(python) scripts/garmin_sync.py ${your email} ${your password}
```

ç¤ºä¾‹ï¼š

```python
python3(python) scripts/garmin_sync.py example@gmail.com example
```

</details>

### Garmin-CN (å¤§é™†ç”¨æˆ·è¯·ç”¨è¿™ä¸ª)

<details>
<summary>è·å–æ‚¨çš„ Garmin-CN æ•°æ®</summary>

> å¦‚æœä½ åªæƒ³åŒæ­¥è·‘æ­¥æ•°æ®è¯·å¢åŠ  --only-run

```python
python3(python) scripts/garmin_sync.py ${your email} ${your password} --is-cn
```

ç¤ºä¾‹ï¼š

```python
python3(python) scripts/garmin_sync.py example@gmail.com example --is-cn
```

ä»…åŒæ­¥è·‘æ­¥æ•°æ®ï¼š

```python
python3(python) scripts/garmin_sync.py example@gmail.com example --is-cn --only-run
```

</details>

### Nike Run Club

<details>
<summary>è·å– Nike Run Club æ•°æ®</summary>

> è¯·æ³¨æ„ï¼šå½“æ‚¨é€‰æ‹©å°† running_page éƒ¨ç½²åœ¨è‡ªå·±çš„æœåŠ¡å™¨ä¸Šæ—¶ï¼Œç”±äº Nike å·²ç»å°ç¦äº†ä¸€éƒ¨åˆ† IDC çš„æœåŠ¡å™¨ IP æ®µï¼Œæ‚¨çš„æœåŠ¡å™¨å¯èƒ½ä¸èƒ½æ­£å¸¸åŒæ­¥ Nike Run Club çš„æ•°æ®å¹¶æ˜¾ç¤º `403 error` ï¼Œè¿™æ—¶æ‚¨å°†ä¸å¾—ä¸é€‰æ‹©å…¶ä»–çš„æ‰˜ç®¡æ–¹å¼ã€‚

è·å– Nike çš„ refresh_token

1. ç™»å½• [Nike](https://www.nike.com) å®˜ç½‘
2. In Developer -> Application-> Storage -> https:unite.nike.com ä¸­æ‰¾åˆ° refresh_token

![image](https://user-images.githubusercontent.com/15976103/94448123-23812b00-01dd-11eb-8143-4b0839c31d90.png) 3. åœ¨é¡¹ç›®æ ¹ç›®å½•ä¸‹æ‰§è¡Œï¼š

```python
python3(python) scripts/nike_sync.py ${nike refresh_token}
```

ç¤ºä¾‹ï¼š

```python
python3(python) scripts/nike_sync.py eyJhbGciThiMTItNGIw******
```

![example img](https://raw.githubusercontent.com/shaonianche/gallery/master/running_page/nike_sync_%20example.png)

</details>

### Strava

<details>
<summary>è·å– Strava æ•°æ®</summary>

1. æ³¨å†Œ/ç™»é™† [Strava](https://www.strava.com/) è´¦å·
2. ç™»é™†æˆåŠŸåæ‰“å¼€ [Strava Developers](http://developers.strava.com) -> [Create & Manage Your App](https://strava.com/settings/api)

3. åˆ›å»º `My API Application`
   è¾“å…¥ä¸‹åˆ—ä¿¡æ¯ï¼š
   ![My API Application](https://raw.githubusercontent.com/shaonianche/gallery/master/running_page/strava_settings_api.png)
   åˆ›å»ºæˆåŠŸï¼š
   ![](https://raw.githubusercontent.com/shaonianche/gallery/master/running_page/created_successfully_1.png)
4. ä½¿ç”¨ä»¥ä¸‹é“¾æ¥è¯·æ±‚æ‰€æœ‰æƒé™
   å°† ${your_id} æ›¿æ¢ä¸º My API Application ä¸­çš„ Client ID åè®¿é—®å®Œæ•´é“¾æ¥

```
https://www.strava.com/oauth/authorize?client_id=${your_id}&response_type=code&redirect_uri=http://localhost/exchange_token&approval_prompt=force&scope=read_all,profile:read_all,activity:read_all,profile:write,activity:write
```

![get_all_permissions](https://raw.githubusercontent.com/shaonianche/gallery/master/running_page/get_all_permissions.png)

5. æå–æˆæƒåè¿”å›é“¾æ¥ä¸­çš„ code å€¼
ä¾‹å¦‚ï¼š

```
http://localhost/exchange_token?state=&code=1dab37edd9970971fb502c9efdd087f4f3471e6e&scope=read,activity:write,activity:read_all,profile:write,profile:read_all,read_all
```

`code` æ•°å€¼ä¸ºï¼š

```
1dab37edd9970971fb502c9efdd087f4f3471e6
```

![get_code](https://raw.githubusercontent.com/shaonianche/gallery/master/running_page/get_code.png) 6. ä½¿ç”¨ Client_idã€Client_secretã€Code è¯·æ±‚ refresch_token
åœ¨ `ç»ˆç«¯/iTerm` ä¸­æ‰§è¡Œï¼š

```
curl -X POST https://www.strava.com/oauth/token \
-F client_id=${Your Client ID} \
-F client_secret=${Your Client Secret} \
-F code=${Your Code} \
-F grant_type=authorization_code
```

ç¤ºä¾‹ï¼š

```
curl -X POST https://www.strava.com/oauth/token \
-F client_id=12345 \
-F client_secret=b21******d0bfb377998ed1ac3b0 \
-F code=d09******b58abface48003 \
-F grant_type=authorization_code
```

![get_refresch_token](https://raw.githubusercontent.com/shaonianche/gallery/master/running_page/get_refresch_token.png)

7. åŒæ­¥æ•°æ®è‡³ Strava
   åœ¨é¡¹ç›®æ ¹ç›®å½•æ‰§è¡Œï¼š

```python
python3(python) scripts/strava_sync.py ${client_id} ${client_secret} ${refresch_token}
```

å…¶ä»–èµ„æ–™å‚è§
<https://developers.strava.com/docs/getting-started>
<https://github.com/barrald/strava-uploader>
<https://github.com/strava/go.strava>

</details>

### TCX_to_Strava

<details>
<summary>ä¸Šä¼ æ‰€æœ‰çš„ tcx æ ¼å¼çš„è·‘æ­¥æ•°æ®åˆ° strava</summary>

<br>

1. å®Œæˆ strava çš„æ­¥éª¤
2. æŠŠ tcx æ–‡ä»¶å…¨éƒ¨æ‹·è´åˆ° TCX_OUT ä¸­
3. åœ¨é¡¹ç›®æ ¹ç›®å½•ä¸‹æ‰§è¡Œ:

```python
python3(python) scripts/tcx_to_strava_sync.py ${client_id} ${client_secret} ${strava_refresch_token}
```

ç¤ºä¾‹ï¼š

```python
python3(python) scripts/tcx_to_strava_sync.py xxx xxx xxx
æˆ–
python3(python) scripts/tcx_to_strava_sync.py xxx xxx xxx --all
```

4. å¦‚æœä½ å·²ç»ä¸Šä¼ è¿‡éœ€è¦è·³è¿‡åˆ¤æ–­å¢åŠ å‚æ•° `--all`

</details>

### GPX_to_Strava

<details>
<summary>ä¸Šä¼ æ‰€æœ‰çš„ gpx æ ¼å¼çš„è·‘æ­¥æ•°æ®åˆ° strava</summary>

<br>

1. å®Œæˆ strava çš„æ­¥éª¤
2. æŠŠ gpx æ–‡ä»¶å…¨éƒ¨æ‹·è´åˆ° GPX_OUT ä¸­
2. åœ¨é¡¹ç›®æ ¹ç›®å½•ä¸‹æ‰§è¡Œ:

```python
python3(python) scripts/gpx_to_strava_sync.py ${client_id} ${client_secret} ${strava_refresch_token}
```

ç¤ºä¾‹ï¼š

```python
python3(python) scripts/gpx_to_strava_sync.py xxx xxx xxx
æˆ–
python3(python) scripts/gpx_to_strava_sync.py xxx xxx xxx --all
```
3. å¦‚æœä½ å·²ç»ä¸Šä¼ è¿‡éœ€è¦è·³è¿‡åˆ¤æ–­å¢åŠ å‚æ•° `--all`

</details>


### Nike+Strava

<details>
<summary>è·å– <code>Nike Run Club</code> çš„è·‘æ­¥æ•°æ®ç„¶ååŒæ­¥åˆ° Strava</summary>

<br>

1. å®Œæˆ nike å’Œ strava çš„æ­¥éª¤
2. åœ¨é¡¹ç›®æ ¹ç›®å½•ä¸‹æ‰§è¡Œ:

```python
python3(python) scripts/nike_to_strava_sync.py ${nike_refresh_token} ${client_id} ${client_secret} ${strava_refresch_token}
```

ç¤ºä¾‹ï¼š

```python
python3(python) scripts/nike_to_strava_sync.py eyJhbGciThiMTItNGIw******  xxx xxx xxx
```


</details>

### Garmin_to_Strava

<details>
<summary>è·å–ä½ çš„<code>ä½³æ˜</code> çš„è·‘æ­¥æ•°æ®ï¼Œç„¶ååŒæ­¥åˆ° Strava</summary>

<br>

1. å®Œæˆ garmin å’Œ strava çš„æ­¥éª¤
2. åœ¨é¡¹ç›®æ ¹ç›®å½•ä¸‹æ‰§è¡Œ:

```python
python3(python) scripts/garmin_to_strava_sync.py  ${client_id} ${client_secret} ${strava_refresch_token} ${garmin_email} ${garmin_password} --is-cn
```

ç¤ºä¾‹ï¼š

```python
python3(python) scripts/garmin_to_strava_sync.py  xxx xxx xxx xx xxx
```

</details>

### Strava_to_Garmin

<details>
<summary>è·å–ä½ çš„<code>Strava</code> çš„è·‘æ­¥æ•°æ®ç„¶ååŒæ­¥åˆ° Garmin</summary>

<br>

1. å®Œæˆ garmin å’Œ strava çš„æ­¥éª¤ï¼ŒåŒæ—¶ï¼Œè¿˜éœ€è¦åœ¨ Github Actions secret é‚£æ–°å¢ Strava é…ç½®ï¼š`secrets.STRAVA_EMAIL`ã€`secrets.STRAVA_PASSWORD`
2. åœ¨é¡¹ç›®æ ¹ç›®å½•ä¸‹æ‰§è¡Œ:

```python
python3(python) scripts/strava_to_garmin_sync.py ${{ secrets.STRAVA_CLIENT_ID }} ${{ secrets.STRAVA_CLIENT_SECRET }} ${{ secrets.STRAVA_CLIENT_REFRESH_TOKEN }}  ${{ secrets.GARMIN_EMAIL }} ${{ secrets.GARMIN_PASSWORD }} ${{ secrets.STRAVA_EMAIL }} ${{ secrets.STRAVA_PASSWORD }}
```

å¦‚æœä½ çš„ä½³æ˜è´¦å·æ˜¯ä¸­å›½åŒºï¼Œæ‰§è¡Œå¦‚ä¸‹çš„å‘½ä»¤ï¼š

```python
python3(python) scripts/strava_to_garmin_sync.py ${{ secrets.STRAVA_CLIENT_ID }} ${{ secrets.STRAVA_CLIENT_SECRET }} ${{ secrets.STRAVA_CLIENT_REFRESH_TOKEN }}  ${{ secrets.GARMIN_CN_EMAIL }} ${{ secrets.GARMIN_CN_PASSWORD }} ${{ secrets.STRAVA_EMAIL }} ${{ secrets.STRAVA_PASSWORD }} --is-cn
```

æ³¨æ„ï¼š**é¦–æ¬¡åˆå§‹åŒ–çš„æ—¶å€™ï¼Œå¦‚æœä½ æœ‰å¤§é‡çš„ strava è·‘æ­¥æ•°æ®ï¼Œå¯èƒ½æœ‰äº›æ•°æ®ä¼šä¸Šä¼ å¤±è´¥ï¼Œåªéœ€è¦å¤šé‡è¯•å‡ æ¬¡å³å¯ã€‚**

</details>


### Total Data Analysis

<details>
<summary>ç”Ÿæˆæ•°æ®å±•ç¤º</summary>

- ç”Ÿæˆæ•°æ®å±•ç¤º SVG
- å±•ç¤ºæ•ˆæœï¼š[ç‚¹å‡»æŸ¥çœ‹](https://raw.githubusercontent.com/yihong0618/running_page/master/assets/github.svg)ã€[ç‚¹å‡»æŸ¥çœ‹](https://raw.githubusercontent.com/yihong0618/running_page/28fa801e4e30f30af5ae3dc906bf085daa137936/assets/grid.svg)

> æ³¨ï¼šæ„Ÿå…´è¶£çš„åŒå­¦å¯ä»¥æ”¹ä¸‹æ–¹å‚æ•° (--special-distance 10 --special-distance2 20, 10km~20km å±•ç¤ºä¸º special-color1 20km ä»¥ä¸Šå±•ç¤ºä¸º special-color2, --min-distance 10.0 ç”¨æ¥ç­›é€‰ 10km ä»¥ä¸Šçš„)

```
python3(python) scripts/gen_svg.py --from-db --title "${{ env.TITLE }}" --type github --athlete "${{ env.ATHLETE }}" --special-distance 10 --special-distance2 20 --special-color yellow --special-color2 red --output assets/github.svg --use-localtime --min-distance 0.5
```

```
python3(python) scripts/gen_svg.py --from-db --title "${{ env.TITLE_GRID }}" --type grid --athlete "${{ env.ATHLETE }}"  --output assets/grid.svg --min-distance 10.0 --special-color yellow --special-color2 red --special-distance 20 --special-distance2 40 --use-localtime
```

ç”Ÿæˆå¹´åº¦ç¯å½¢æ•°æ®

```
python3(python) scripts/gen_svg.py --from-db --type circular --use-localtime
```

æ›´å¤šå±•ç¤ºæ•ˆæœå‚è§ï¼š
<https://github.com/flopp/GpxTrackPoster>

</details>

## server(recommend vercel)

<details>
<summary>ä½¿ç”¨ Vercel éƒ¨ç½²</summary>

1. vercel è¿æ¥ä½ çš„ GitHub repo

![image](https://user-images.githubusercontent.com/15976103/94452465-2599b880-01e2-11eb-9538-582f0f46c421.png)

2. import repo

![image](https://user-images.githubusercontent.com/15976103/94452556-3f3b0000-01e2-11eb-97a2-3789c2d60766.png)

2. ç­‰å¾…éƒ¨ç½²å®Œæ¯•
3. è®¿é—®

</details>

<details>
<summary> ä½¿ç”¨ Cloudflare éƒ¨ç½² </summary>
<br>

1. åœ¨ `Pages` ä¸­ç‚¹å‡» `Create a project` ä»¥è¿æ¥åˆ°ä½ çš„ä»“åº“

2. ç‚¹å‡» `Begin setup` åï¼Œä¿®æ”¹é¡¹ç›®çš„ `Build settings`ã€‚

3. åœ¨ `Framework preset` ä¸­é€‰æ‹© `Gatsby` æ¡†æ¶ã€‚

4. å‘ä¸‹æ»šåŠ¨ï¼Œç‚¹å‡» `Environment variables` ä¿®æ”¹å˜é‡å¦‚ä¸‹ï¼š

   > Variable name = `PYTHON_VERSION`, Value = `3.7`

5. ç‚¹å‡» `Save and Deploy`ï¼Œå®Œæˆéƒ¨ç½²ã€‚

</details>

<details>
<summary> éƒ¨ç½²åˆ° GitHub Pages </summary>

1. é…ç½® GitHub Actionã€‚å¦‚éœ€ä½¿ç”¨è‡ªå®šä¹‰åŸŸåï¼Œå¯ä»¥ä¿®æ”¹ [.github/workflows/gh-pages.yml](.github/workflows/gh-pages.yml) ä¸­çš„ `fqdn`ï¼ˆé»˜è®¤å·²æ³¨é‡Šæ‰ï¼‰

2. ä¿®æ”¹ `gatsby-config.js`ï¼Œæ›´æ–° `pathPrefix`ã€‚ã€å¦‚æœä½¿ç”¨è‡ªå®šä¹‰åŸŸåï¼Œå¯è·³è¿‡è¿™ä¸€æ­¥ã€‘

3. åœ¨é¡¹ç›®çš„ `Actions -> Workflows -> All Workflows` ä¸­é€‰æ‹© Publish GitHub Pagesï¼Œç‚¹å‡» `Run workflow`

4. åœ¨é¡¹ç›®çš„ `Settings -> GitHub Pages -> Source` éƒ¨åˆ†ï¼Œé€‰æ‹© `Branch: gh-pages` å¹¶ç‚¹å‡» `Save`ã€‚

</details>

## GitHub Pagesæ–¹æ¡ˆé…ç½®
<details>
<summary>é…ç½®æµç¨‹ï¼Œ<a href='https://github.com/yihong0618/running_page/blob/master/docs/TulipSport.md'>éƒé‡‘é¦™æ–¹æ¡ˆç¤ºä¾‹</a> </summary>

> æœ‰ä»¥ä¸‹æƒ…å†µçš„ç”¨æˆ·å»ºè®®é€‰æ‹©è‡ªå»ºæœåŠ¡çš„æ–¹æ¡ˆ
> 1. ç›®æ ‡è®¿é—®ç”¨æˆ·çš„ç½‘ç»œä¸å¤Ÿé€šç•…ï¼›
> 2. å…³æ³¨æ•°æ®éšç§ï¼ˆpsï¼šå¤–æ”¾çš„é¡µé¢å†…ä¹Ÿèƒ½æ‹¿åˆ°å¤§éƒ¨åˆ†çš„æ•°æ®ğŸ˜„ï¼‰ã€‚

1. ä¸ºGitHub Actionsæ·»åŠ ä»£ç æäº¤æƒé™ï¼›
   è®¿é—®ä»“åº“çš„ `Settings > Actions > General`é¡µé¢ï¼Œæ‰¾åˆ°`Workflow permissions`çš„è®¾ç½®é¡¹ï¼Œå°†é€‰é¡¹é…ç½®ä¸º`Read and write permissions`ï¼Œæ”¯æŒCIå°†è¿åŠ¨æ•°æ®æ›´æ–°åæäº¤åˆ°ä»“åº“ä¸­ã€‚
2. æ›´æ–°é…ç½®å¹¶æäº¤ä»£ç ï¼›
   1. æ›´æ–°`./gatsby-config.js`ä¸­çš„`siteMetadata`èŠ‚ç‚¹ï¼›
   2. æ›´æ–°GitHub CIçš„é…ç½®`./.github/workflows/run_data_sync.yml`ä¸­çš„é…ç½®ï¼›
   3. åœ¨ä»“åº“çš„`Settings > Secrets and variables > Actions`é¡µé¢æ·»åŠ å¯¹åº”æœåŠ¡çš„ç¯å¢ƒé…ç½®ä¿¡æ¯ã€‚
3. åŒæ­¥æ•°æ®å¹¶å‘å¸ƒGitHub Pages
   1. æ‰‹åŠ¨è§¦å‘`Run Data Sync`çš„Github Actionå®Œæˆæ•°æ®åŒæ­¥ï¼›
   2. å¼€é€šä»“åº“GitHub PagesåŠŸèƒ½ï¼Œé€‰æ‹©`gh-pages`åˆ†æ”¯å’Œ`/(root)`ç›®å½•ã€‚
</details>

## GitHub Actions (Fork çš„åŒå­¦è¯·ä¸€å®šä¸è¦å¿˜äº†æŠŠ GitHub Token æ”¹æˆè‡ªå·±çš„ï¼Œå¦åˆ™ä¼š push åˆ°æˆ‘çš„ repo ä¸­ï¼Œè°¢è°¢å¤§å®¶ã€‚)

<details>
<summary>ä¿®æ”¹ GitHub Actions Token</summary>

Actions [æºç ](https://github.com/yihong0618/running_page/blob/master/.github/workflows/run_data_sync.yml)
éœ€è¦åšå¦‚ä¸‹æ­¥éª¤

1. æ›´æ”¹æˆä½ çš„ app type åŠ info
   ![image](https://user-images.githubusercontent.com/15976103/94450124-73f98800-01df-11eb-9b3c-ac1a6224f46f.png)
2. åœ¨ repo Settings > Secrets ä¸­å¢åŠ ä½ çš„ secret (åªæ·»åŠ ä½ éœ€è¦çš„å³å¯)
   ![image](https://user-images.githubusercontent.com/15976103/94450295-aacf9e00-01df-11eb-80b7-a92b9cd1461e.png)
   æˆ‘çš„ secret å¦‚ä¸‹
   ![image](https://user-images.githubusercontent.com/15976103/94451037-8922e680-01e0-11eb-9bb9-729f0eadcdb7.png)

</details>

# TODO

- [x] å®Œå–„è¿™ä¸ªæ–‡æ¡£
- [x] æ”¯æŒä½³æ˜ï¼Œä½³æ˜ä¸­å›½
- [x] æ”¯æŒ keep
- [ ] æ”¯æŒè‹¹æœè‡ªå¸¦è¿åŠ¨
- [x] æ”¯æŒ nike + strava
- [x] æ”¯æŒå’•å’š
- [ ] å°è¯•æ”¯æŒå°ç±³è¿åŠ¨
- [x] æ”¯æŒè‹±è¯­
- [x] å®Œå–„ä»£ç 
- [x] æ¸…ç†æ•´ä¸ªé¡¹ç›®
- [x] å®Œå–„å‰ç«¯ä»£ç 
- [x] better actions
- [ ] tests
- [ ] æ”¯æŒä¸åŒçš„è¿åŠ¨ç±»å‹

# å‚ä¸é¡¹ç›®

- ä»»ä½• Issues PR å‡æ¬¢è¿ã€‚
- å¯ä»¥æäº¤ PR share è‡ªå·±çš„ Running page åœ¨ README ä¸­ã€‚

æäº¤ PR å‰ï¼š

- ä½¿ç”¨ black å¯¹ Python ä»£ç è¿›è¡Œæ ¼å¼åŒ–ã€‚(`black .`)

# ç‰¹åˆ«æ„Ÿè°¢

- @[flopp](https://github.com/flopp) ç‰¹åˆ«æ£’çš„é¡¹ç›® [GpxTrackPoster](https://github.com/flopp/GpxTrackPoster)
- @[danpalmer](https://github.com/danpalmer) åŸå§‹çš„ UI è®¾è®¡
- @[shaonianche](https://github.com/shaonianche) icon è®¾è®¡åŠæ–‡æ¡£
- @[geekplux](https://github.com/geekplux) å¸®åŠ©åŠé¼“åŠ±ï¼Œé‡æ„äº†å‰ç«¯ä»£ç ï¼Œå­¦åˆ°äº†ä¸å°‘
- @[ben-29](https://github.com/ben-29) æå®šäº†å’•å’šï¼Œå’Œæˆ‘ä¸€èµ·æå®šäº†æ‚¦è·‘åœˆï¼Œå¤ªå‰å®³äº†
- @[MFYDev](https://github.com/MFYDev) Wiki

# æ¨èçš„ Forks

- @[gongzili456](https://github.com/gongzili456) for [æ‘©æ‰˜è½¦éª‘è¡Œç‰ˆæœ¬](https://github.com/gongzili456/running_page)
- @[ben-29](https://github.com/ben-29) for [å¤šç§è¿åŠ¨ç±»å‹æ”¯æŒ](https://github.com/ben-29/workouts_page)
- @[geekplux](https://github.com/geekplux) for [å¤šç§è¿åŠ¨ç±»å‹æ”¯æŒ](https://github.com/geekplux/activities)

# èµèµ

è°¢è°¢å°±å¤Ÿäº†

 # FAQ
### Strava 100 æ¯ 15 åˆ†é’Ÿçš„è¯·æ±‚ï¼Œ 1000 æ¯æ—¥é™åˆ¶
https://www.strava.com/settings/api
https://developers.strava.com/docs/#rate-limiting

ç­‰å¾…æ—¶é—´é™åˆ¶ï¼ˆè¿™é‡Œæ˜¯stravaæ¥å£è¯·æ±‚é™åˆ¶ï¼‰ï¼Œä¸è¦å…³é—­ç»ˆç«¯ï¼Œè¿™é‡Œä¼šè‡ªåŠ¨æ‰§è¡Œä¸‹ä¸€ç»„ä¸Šä¼ æ•°æ®
```
Strava API Rate Limit Exceeded. Retry after 100 seconds
Strava API Rate Limit Timeout. Retry in 799.491622 seconds
```
